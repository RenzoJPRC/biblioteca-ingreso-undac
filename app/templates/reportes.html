{% extends "base_admin.html" %}

{% block title %}Reportes Avanzados - Biblioteca UNDAC{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/reportes.css">
{% endblock %}

{% block header_title %}Reportes Gerenciales{% endblock %}

{% block content %}
<div class="container-fluid">

    <div class="filters-card">
        <div class="filter-group">
            <span class="filter-label">Desde:</span>
            <input type="date" id="startDate" class="date-input">
        </div>
        <div class="filter-group">
            <span class="filter-label">Hasta:</span>
            <input type="date" id="endDate" class="date-input">
        </div>
        <button onclick="loadData()" class="btn-apply">Actualizar Reporte</button>
        <a href="/admin/reporte/excel" class="btn-excel"
            style="margin-left: 1rem; text-decoration: none; padding: 0.6rem 1rem; background-color: #10b981; color: white; border-radius: 0.4rem; font-size: 0.9rem; font-weight: 500;">游늵
            Descargar Excel</a>
    </div>

    <div class="dashboard-grid">
        <!-- KPIs -->
        <div class="card kpi-card">
            <div class="kpi-val" id="kpiTotal">-</div>
            <div class="kpi-label">Total Ingresos Periodo</div>
        </div>
        <div class="card kpi-card">
            <div class="kpi-val" id="kpiAvg">-</div>
            <div class="kpi-label">Promedio Diario</div>
        </div>
        <div class="card kpi-card">
            <div class="kpi-val" id="kpiUnique">-</div>
            <div class="kpi-label">Estudiantes 칔nicos</div>
        </div>
        <div class="card kpi-card">
            <div class="kpi-val" id="kpiTopDay">-</div>
            <div class="kpi-label">D칤a M치s Concurrido</div>
        </div>

        <!-- Charts Row 1 -->
        <div class="card chart-card-lg">
            <h3 class="card-title">Tendencia de Asistencia (Por D칤a)</h3>
            <div class="chart-container">
                <canvas id="chartTrend"></canvas>
            </div>
        </div>

        <div class="card chart-card-sm">
            <h3 class="card-title">Distribuci칩n por Facultad</h3>
            <div class="chart-container">
                <canvas id="chartFacultad"></canvas>
            </div>
        </div>

        <!-- Table -->
        <div class="card table-card">
            <h3 class="card-title">Top 10 Escuelas con M치s Asistencia</h3>
            <table>
                <thead>
                    <tr>
                        <th>Posici칩n</th>
                        <th>Escuela Profesional</th>
                        <th>Facultad</th>
                        <th style="text-align:right;">Total Ingresos</th>
                    </tr>
                </thead>
                <tbody id="tableSchoolsBody">
                    <!-- JS generated -->
                </tbody>
            </table>
        </div>

    </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/reportes.js"></script>
{% endblock %}